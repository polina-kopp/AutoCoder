<div class="step-text">
<p></p>
<h5 id="description">Description</h5>
<p>Integrate OpenAI's ChatGPT into the workflow to generate code based on an issue's content. To streamline the process, a script file: <a href="https://cogniterra.org/media/attachments/lesson/38647/interaction_script.sh" rel="noopener noreferrer nofollow" target="_blank">script.sh</a> has been created for you. Feel free to use it as it is or use it as a reference to create your own script. This provided script will perform the following:</p>
<ul>
<li>
<p>Retrieve the issue number, repository, and authentication keys from the environment;</p>
</li>
<li>
<p>Use the GitHub API to retrieve the issue and extract the body that contains the prompt;</p>
</li>
<li>
<p>Add additional instructions, format the prompt, and send it to ChatGPT;</p>
</li>
<li>
<p>Extract the code snippets from the response and save all of them to their respective files inside the <em>autocoder-bot</em> directory;</p>
</li>
</ul>
<p>In this stage, modify your workflow to ensure that the correct environment is set up to run the script. Then, run the script file to generate code based on the issue content. Once the script has run, upload the generated files an artifact; then, download and list the contents of the artifact in the workflow logs.</p>
<h5 id="objectives">Objectives</h5>
<ul>
<li>
<p>Download the script file: <a href="https://cogniterra.org/media/attachments/lesson/38647/interaction_script.sh" rel="noopener noreferrer nofollow" target="_blank">script.sh</a> and study it to understand how it works;</p>
</li>
<li>
<p>Copy the contents of the provided script file and paste them into the script file you created earlier in your repository;</p>
</li>
<li>
<p>Identify the environment variables needed by the script and pass them to the script in the workflow file. Remember to pass them in the expected order;</p>
</li>
<li>
<p>Create a new repository secret for your repo with your <a href="https://platform.openai.com/account/api-keys" rel="noopener noreferrer nofollow" target="_blank">OpenAI key</a> as the value:</p>
<ul>
<li>
<p><code class="language-yaml">OPENAI_API_KEY</code> - Your OpenAI API key;</p>
</li>
</ul>
</li>
<li>
<p>Use an if statement in your workflow to check if the issue has the label <em>autocoder-bot</em> using payload information from the issue event;</p>
</li>
<li>
<p>The job or jobs in your workflow should have steps that do the following:</p>
<ul>
<li>
<p>Make the script file executable by adding an execute <code class="language-yaml">+x </code>permission;</p>
</li>
<li>
<p>Run the script file and pass the necessary environment variables to it;</p>
</li>
<li>
<p>Upload the content returned by the script as an artifact with the name <code class="language-yaml">autocoder-artifact</code>;</p>
</li>
<li>
<p>Download the artifact to a directory named <code class="language-yaml">autocoder-artifact</code>;</p>
</li>
<li>
<p>List all the files ensuring to list directories and files recursively;</p>
</li>
</ul>
</li>
</ul>
<p></p><div class="alert alert-warning"> You need a valid OpenAI API key for the script to generate code with ChatGPT. If you don't have one, you can get it from <a href="https://platform.openai.com/account/api-keys" rel="noopener noreferrer nofollow" target="_blank">OpenAI</a>. </div>
<h5 id="examples">Examples</h5>
<p><strong>Example 1</strong></p>
<pre><code class="language-yaml">
steps:
  - name: Generate Code with ChatGPT
    id: generate_code
    env:
      # first env key: value
      # second env key: value
    run: # ./path to script ${{ env.key }} ${{ env.key }}
  - name: Upload Artifact
    # action to upload an artifact
    # params:
      # inputs
      # inputs
  - name: Display Generated Code using the ls command
    # output code</code></pre>
<p style="text-align: center;"><picture><source media="(max-width: 480px)" srcset="https://ucarecdn.com/2b2c6c01-0f38-48f6-b119-9476c1e87a76/-/stretch/off/-/resize/480x/-/format/webp/ 1x,https://ucarecdn.com/2b2c6c01-0f38-48f6-b119-9476c1e87a76/-/stretch/off/-/resize/960x/-/format/webp/ 2x,https://ucarecdn.com/2b2c6c01-0f38-48f6-b119-9476c1e87a76/-/stretch/off/-/resize/1440x/-/format/webp/ 3x" type="image/webp"/><source media="(max-width: 800px)" srcset="https://ucarecdn.com/2b2c6c01-0f38-48f6-b119-9476c1e87a76/-/stretch/off/-/resize/800x/-/format/webp/ 1x,https://ucarecdn.com/2b2c6c01-0f38-48f6-b119-9476c1e87a76/-/stretch/off/-/resize/1600x/-/format/webp/ 2x,https://ucarecdn.com/2b2c6c01-0f38-48f6-b119-9476c1e87a76/-/stretch/off/-/resize/2400x/-/format/webp/ 3x" type="image/webp"/><source srcset="https://ucarecdn.com/2b2c6c01-0f38-48f6-b119-9476c1e87a76/-/stretch/off/-/resize/1100x/-/format/webp/ 1x,https://ucarecdn.com/2b2c6c01-0f38-48f6-b119-9476c1e87a76/-/stretch/off/-/resize/2200x/-/format/webp/ 2x,https://ucarecdn.com/2b2c6c01-0f38-48f6-b119-9476c1e87a76/-/stretch/off/-/resize/3000x/-/format/webp/ 3x" type="image/webp"/><img alt="Workflow run for the stage" height="409" src="https://ucarecdn.com/2b2c6c01-0f38-48f6-b119-9476c1e87a76/" width="1000"/></picture></p>
<p>After fulfilling the objectives, head back to your IDE and provide the full URL of the repository. Finally, hit the <em>Check</em> button.</p>
</div>